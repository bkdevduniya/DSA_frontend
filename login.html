<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>login</title>
    <link rel="stylesheet" href="./form.css">
</head>
<body>
    <div id="response-message" >

    </div>
    <form action="http://localhost:5000/auth/login" method="post" id="user-form">
        <label for="email">email</label>
        <input name="email" id="email" type="email" placeholder="email"><br>
        <label for="password">password</label>
        <input id="password" name="password" type="password" placeholder="password"><br>
        <button type="submit">login</button>
        <div id="another-option">Not rgistered ? <a href="./signup.html">signup</a></div>
    </form>
    <script>
    document.getElementById('user-form').addEventListener('submit', async function (e) {
    e.preventDefault(); // Prevent traditional form submission

    const formData = new FormData(this);
    
    const data = Object.fromEntries(formData.entries());
    
    try {
      const res = await fetch('http://localhost:5000/auth/login',{
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
        credentials: 'include'
      });
      console.log(res);
      const result = await res.json(); // Assuming your server returns JSON

      // Show the response message on the page
      if(result.msg=="invalid credentials"){
        let x=document.getElementById('response-message');
           x.style.visibility = 'visible';
          x.innerText = result.msg;
      }
      else if(result.msg=="login success"){
        let x=document.getElementById('response-message');
          x.style.visibility = 'visible';
          x.style.color = 'green';
          x.style.border = 'solid 1px green';
          x.style.boxShadow = '3px 3px 3px green, -3px -3px 3px green';
          x.innerText = result.msg;
          window.location.reload();
          window.location.href = '/';
      }
    } catch (err) {
      console.error('Error:', err);
    }
  });
</script>
    
</body>
</html>